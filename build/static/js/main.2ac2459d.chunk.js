(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{165:function(e,t,a){},187:function(e,t,a){e.exports=a(373)},371:function(e,t,a){},373:function(e,t,a){"use strict";a.r(t);var n=a(0),i=a.n(n),r=a(23),s=a.n(r),o=a(32),c=a(33),l=a(37),p=a(34),u=a(36),d=a(103),h=a(68),v=a(170),m="UPDATE_VIEW";var b="SET_LOADING";function y(e){return{type:b,loading:e}}var f={availableViews:["visits","map"],loading:!1,view:"visits"},g=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:f,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case b:return Object.assign({},e,{loading:void 0!==t.loading&&t.loading});case m:return Object.assign({},e,{view:t.view});default:return e}},E={visitServerEndpoint:"/api/metrics/"},O=a(171);function j(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t="".concat(E.visitServerEndpoint,"/").concat(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t="",a=!0;for(var n in e)e[n]&&"query_type"!==n&&(a=!1);if(a)return t;for(var i in e)t+="&".concat(i,"=").concat(e[i]);t.length>0&&(t="?"+t.substr(1,t.length));return t}(e));return O.get(t).then(function(e){return{success:!0,data:e.data}}).catch(function(e){return{success:!1,err:e.response.data}})}var _="UPDATE_VISITS";var k="SET_SELECTED_VISIT";function w(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];x.dispatch(y(!0)),j(e).then(function(e){var t;e.success&&void 0!==e.data&&x.dispatch((t=e.data,{type:_,visits:t})),x.dispatch(y(!1))})}var C="UPDATE_QUERY";function S(){var e=x.getState().search.query;return w({ip:e,city:e,country_code:e,country_name:e,region_code:e,time_zone:e,zip_code:e,visit_date:e,query_type:"or"})}var I={query:""},T=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:I,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case C:return Object.assign({},e,{query:t.query});default:return e}},z={visits:[],selectedVisit:{}},V=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:z,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case _:return Object.assign({},e,{visits:t.visits});case k:return Object.assign({},e,{selectedVisit:t.visit});default:return e}},M="UPDATE_POSITION";var q="UPDATE_ZOOM";var A={position:[38.87900161743164,-76.98979949951172],zoom:3},D=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:A,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case M:return Object.assign({},e,{position:t.position});case q:return Object.assign({},e,{zoom:t.zoom});default:return e}},P=Object(h.c)({appState:g,map:D,search:T,visits:V}),R=Object(v.createLogger)({collapsed:!0,diff:!0}),x=Object(h.d)(P,Object(h.a)(R)),U=a(29),L=a(182),N=a.n(L),H=a(183),B=a.n(H),W=a(184),G=a.n(W),J=a(127),Z=a.n(J),K=a(185),Q=a.n(K),X=a(180),Y=a.n(X),F=a(181),$=a.n(F),ee=a(172),te=a.n(ee),ae=a(173),ne=a.n(ae),ie=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(p.a)(t).call(this,e)))._handleInputChange=a._handleInputChange.bind(Object(U.a)(Object(U.a)(a))),a}return Object(u.a)(t,e),Object(c.a)(t,[{key:"_handleInputChange",value:function(e){var t;arguments.length>1&&void 0!==arguments[1]&&arguments[1];e&&e.target&&void 0!==e.target.value&&x.dispatch((t=e.target.value,{type:C,query:t}))}},{key:"render",value:function(){var e=this;return i.a.createElement("div",{id:"search-bar"},i.a.createElement(te.a,{id:"search-bar-input",type:"search",margin:"normal",onChange:this._handleInputChange,onKeyPress:function(t){"Enter"!==t.key||e.props.disabled||(S(),t.preventDefault())},placeholder:"Search 'Israel', '02067', 'MN', 'Boston'",style:{width:600,padding:15},disabled:this.props.disabled}),i.a.createElement(ne.a,{id:"search-bar-button",variant:"raised",color:"primary",onClick:S,disabled:this.props.disabled},"Search"))}}]),t}(i.a.Component),re=a(89),se=a.n(re),oe=a(174),ce=a.n(oe),le=a(176),pe=a.n(le),ue=a(109),de=a.n(ue),he=a(175),ve=a.n(he),me=a(126),be=a.n(me),ye=a(87),fe=a.n(ye),ge={root:{width:"100%",marginTop:24,overflowX:"auto"},table:{minWidth:700}},Ee=[{display:"Ip Address",key:"ip"},{display:"City",key:"city"},{display:"State or Region",key:"region_code"},{display:"Country",key:"country_code"},{display:"Visit Date",key:"visit_date"},{display:"Ref",key:"href"}],Oe=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(p.a)(t).call(this,e)))._handleRowClick=a._handleRowClick.bind(Object(U.a)(Object(U.a)(a))),a}return Object(u.a)(t,e),Object(c.a)(t,[{key:"_handleRowClick",value:function(e){void 0!==this.props.visits.selectedVisit&&this.props.visits.selectedVisit.visit_date===e.visit_date||x.dispatch(function(e){return{type:k,visit:e}}(e))}},{key:"render",value:function(){var e=this;return i.a.createElement(fe.a,{style:ge.root},i.a.createElement(ce.a,{style:ge.table},i.a.createElement(ve.a,null,i.a.createElement(be.a,null,Ee.map(function(e,t){return i.a.createElement(de.a,{key:t},e.display)}))),i.a.createElement(pe.a,null,this.props.visits.visits.map(function(t,a){return i.a.createElement(be.a,{hover:!0,key:a,onClick:function(){return e._handleRowClick(t)}},Ee.map(function(e,a){return"href"===e.key&&(t.href=t.href.substr(1)),"visit_date"===e.key?i.a.createElement(de.a,{key:a},i.a.createElement(se.a,{date:t.visit_date,live:!0})):i.a.createElement(de.a,{key:a},t[e.key])}))}))))}}]),t}(i.a.Component),je=a(375),_e=a(378),ke=a(376),we=a(374),Ce=a(377),Se=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props.visit;return i.a.createElement(ke.a,{center:[e.latitude,e.longitude],color:"#3f51b5",radius:2e3,opacity:.001},i.a.createElement(we.a,{position:[e.latitude,e.longitude],color:"#3f51b5"},i.a.createElement(Ce.a,null,function(e){return i.a.createElement("div",null,i.a.createElement("h3",null,i.a.createElement(se.a,{date:e.visit_date,live:!0})),i.a.createElement("h5",null,"City : ",e.city,", ",e.region_code," ",e.zip_code," ",e.country_code,i.a.createElement("br",null),"Lat, Lon : ",e.latitude,",",e.longitude,i.a.createElement("br",null),"Ip Address : ",e.ip,i.a.createElement("br",null),"GMT : ",e.visit_date,i.a.createElement("br",null),"Ref : ",e.href))}(e))))}}]),t}(i.a.Component),Ie=(a(348),a(165),a(178)),Te=a.n(Ie),ze={leafletMap:{height:400,width:1e3,padding:"100px"}},Ve=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){if(!0!==this.props.testingMode){var e=this.leafletMap.leafletElement;e.on("zoomend",function(){var t;x.dispatch((t=e.getZoom(),{type:q,zoom:t}))})}}},{key:"render",value:function(){var e=this,t=void 0!==this.props.visits[0]?[this.props.visits[0].latitude,this.props.visits[0].longitude]:this.props.map.position;return i.a.createElement("div",null,i.a.createElement("h1",null," Showing ",this.props.visits.length," visits to your website from ",Te.a.uniqBy(this.props.visits,"ip").length," distinct IP Addresses"),i.a.createElement("div",{className:"map-component",id:"map-component"},i.a.createElement(je.a,{ref:function(t){e.leafletMap=t},clas:"leaflet-map",zoom:this.props.map.zoom,center:t,style:ze.leafletMap},i.a.createElement(_e.a,{attribution:'&copy <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),this.props.visits.map(function(e,t){return i.a.createElement(Se,{visit:e,key:t})}))))}}]),t}(i.a.Component),Me=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(l.a)(this,Object(p.a)(t).call(this,e)))._getIconHelper=a._getIconHelper.bind(Object(U.a)(Object(U.a)(a))),a._handleTabChange=a._handleTabChange.bind(Object(U.a)(Object(U.a)(a))),a}return Object(u.a)(t,e),Object(c.a)(t,[{key:"_handleTabChange",value:function(e,t){var a=this.props.appState.availableViews[t];if(!a)throw"Could not find tab with index "+t;this.props.dispatch({type:m,view:a})}},{key:"_getIconHelper",value:function(e){return"visits"===e?i.a.createElement(Y.a,null):"map"===e?i.a.createElement($.a,null):void 0}},{key:"render",value:function(){var e=this;return i.a.createElement("div",{id:"main-view-controller"},i.a.createElement(ie,{query:this.props.search.query,disabled:this.props.appState.loading}),i.a.createElement(N.a,{position:"static",color:"default",id:"app-bar"},i.a.createElement(B.a,{value:this.props.appState.availableViews.indexOf(this.props.appState.view),onChange:this._handleTabChange,indicatorColor:"primary",textColor:"primary",centered:!0},this.props.appState.availableViews.map(function(t,a){return i.a.createElement(G.a,{label:t,key:a,id:t,icon:e._getIconHelper(t),disabled:e.props.appState.loading})}))),this.props.appState.loading&&i.a.createElement(Q.a,{id:"loading-spinner",color:"primary",style:{padding:100},size:200,thickness:1}),!this.props.appState.loading&&"visits"===this.props.appState.view&&i.a.createElement(Z.a,{component:"div",style:{padding:24}},i.a.createElement(Oe,{visits:this.props.visits})),!this.props.appState.loading&&"map"===this.props.appState.view&&i.a.createElement(Z.a,{component:"div",style:{padding:24}},i.a.createElement(Ve,{visits:this.props.visits.visits,map:this.props.map})))}}]),t}(i.a.Component),qe=Object(d.b)(function(e){return e})(Me),Ae=function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(c.a)(t,[{key:"componentWillMount",value:function(){w()}},{key:"render",value:function(){return i.a.createElement("div",{className:"App"},i.a.createElement(d.a,{store:x},i.a.createElement(qe,null)))}}]),t}(n.Component);a(371);s.a.render(i.a.createElement(Ae,null),document.getElementById("root"))}},[[187,2,1]]]);
//# sourceMappingURL=main.2ac2459d.chunk.js.map